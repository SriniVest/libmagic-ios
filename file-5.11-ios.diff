--- file-5.11/src/file.h.orig	2011-09-21 00:30:14.000000000 +0900
+++ file-5.11/src/file.h	2013-05-07 23:18:53.000000000 +0900
@@ -34,7 +34,7 @@
 #define __file_h__
 
 #ifdef HAVE_CONFIG_H
-#include <config.h>
+#include "config.h"
 #endif
 
 #ifdef WIN32
--- file-5.11/src/magic.h.orig	2011-12-18 23:54:43.000000000 +0900
+++ file-5.11/src/magic.h	2013-05-07 23:07:03.000000000 +0900
@@ -101,4 +101,10 @@ int magic_errno(magic_t);
 };
 #endif
 
+#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED
+const char *magic_ios_get_plain_magic(void);
+const char *magic_ios_get_default_magic(void);
+int magic_ios_compile(void);
+#endif
+
 #endif /* _MAGIC_H */
--- file-5.11/src/magic.c.orig	2011-05-26 10:27:59.000000000 +0900
+++ file-5.11/src/magic.c	2013-05-07 23:07:03.000000000 +0900
@@ -204,7 +204,11 @@ magic_getpath(const char *magicfile, int
 	if (magicfile != NULL)
 		return magicfile;
 
+#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED
+	return action == FILE_LOAD ? magic_ios_get_default_magic() : magic_ios_get_plain_magic();
+#else
 	return action == FILE_LOAD ? get_default_magic() : MAGIC;
+#endif
 }
 
 public struct magic_set *
